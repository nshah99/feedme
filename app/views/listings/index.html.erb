<h1 class="text-centered text-muted">Listings</h1>
 
 <%= form_tag listings_path, class: "form-group", :method => 'get' do %>
   <div class="row">
    <div class="col-xs-5">
    <%= text_field_tag :search, params[:search],placeholder:"Find chinese,dosa",class: "form-control" %> </div>
    <div class="col-xs-5">
    <%= text_field_tag :location, params[:location],placeholder:"Near Atlanta/" , class: "form-control" %> </div>
    <div class="col-xs-2">
    <%= submit_tag "Search", :name => nil , class: "btn btn-small"%></div>
   
    </div>

<!-- Insert map here -->
    <!--<div id="map"></div>-->

  <div id="tog" class="container collapse-group">
    <div class="row">
    <p class="text-left"><a class="btn showdetails" data-toggle="collapse" data-target="#hideme">Filters &raquo;</a></p>
  </div>
    <div id="hideme" class="collapse">
            <div class="col-xs-6">
                       <ul class="list-inline">
                        <li><h2>Filter By Price</h2></li><br>
                        <l1> <div class="checkbox-inline"><%= check_box_tag(:cheap) %> <%= label_tag(:cheap, "Low Price (<$5)") %> </div></li>
                        <li> <div class="checkbox-inline"><%= check_box_tag(:average) %> <%= label_tag(:average, "Average Price ($5-$15)") %></div></li>
                        <li><div class="checkbox-inline"><%= check_box_tag(:expensive) %> <%= label_tag(:expensive, "High Price (>$15)") %></div> </li>
                      </ul>  
            </div>
             <div class="col-xs-6">
                       <ul class="list-inline">
                <li><h2>Filter By Distance</h2></li><br>
                             <li>
                                <div class="field">
                                <%= radio_button_tag(:close,1) %>
                              <%= label_tag(:close, "Less than a mile ",:style =>"display:inline") %>
                              </div>
                               <div class="field">
                                <%= radio_button_tag(:far,1) %>
                              <%= label_tag(:far, "Less than 5 miles ",:style =>"display:inline") %>
                              </div> 
                            </li> </ul>
            </div>
  </div>
</div>
   
  <% end %>

  <% @listing.each do |f|%>
  <hr>
  <div class="row">
  <div class="col-xs-2">  
      <img src="http://chewoutloud.files.wordpress.com/2013/02/deep-dish-pizza.jpg" alt="Pizza" class="img-thumbnail"> <!-- chef or listing image -->
  </div>    
  <div class="col-xs-5 pull-left">  
     <p>Item: <%= link_to f.item, listings_path+"/"+f.id.to_s%></p> <br>
     <p>Chef: <%= link_to f.name, users_path+"/"+f.user_id.to_s %></p> <br>
     <p>Location: <%= f.address%></p><br>    
  </div>  
  <div class="col-xs-5 pull-right">
           <p>Expected Time: <%= f.expected_time%></p><br>
           <p>Price: <%= f.price%></p><br>
           <p>Quantiy: <%= f.quantity%></p>
  </div>   


<!--   Chef: <%= link_to f.name, users_path+"/"+f.user_id.to_s %> <br>
  Item: <%= link_to f.item, listings_path+"/"+f.id.to_s%><br>
  Location: <%= f.address%><br>
  Price: <%= f.price%><br>
  Quantiy: <%= f.quantity%><br>
  Expected Time: <%= f.expected_time%><br>
  Number of reviews for this listing: <%= f.reviews.count%><br>
  Number of reviews for this chef: <%= f.user.reviews.count%><br><br> -->
  </div>
  <hr>
  <% end %>

<script type='text/javascript'>
 var map = L.mapbox.map('map', 'examples.map-9ijuk24y');

 var geoJson = [{
     type: 'Feature',
     "geometry": { "type": "Point", "coordinates": [-77.03, 38.90]},
     "properties": {
         "image": "http://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Cherry_Blossoms_and_Washington_Monument.jpg/320px-Cherry_Blossoms_and_Washington_Monument.jpg",
         "url": "http://en.wikipedia.org/wiki/Washington,_D.C.",
         "marker-symbol": "star",
         "city": "Washington, D.C."
     }
 }, {
     type: 'Feature',
     "geometry": { "type": "Point", "coordinates": [-87.63, 41.88]},
     "properties": {
         "image": "http://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Chicago_sunrise_1.jpg/640px-Chicago_sunrise_1.jpg",
         "url": "http://en.wikipedia.org/wiki/Chicago",
         "city": "Chicago"
     }
 }, {
     type: 'Feature',
     "geometry": { "type": "Point", "coordinates": [-74.00, 40.71]},
     "properties": {
         "image": "http://upload.wikimedia.org/wikipedia/commons/thumb/3/39/NYC_Top_of_the_Rock_Pano.jpg/640px-NYC_Top_of_the_Rock_Pano.jpg",
         "url": "http://en.wikipedia.org/wiki/New_York_City",
         "city": "New York City"
     }
 }];

// Add custom popups to each using our custom feature properties
 map.markerLayer.on('layeradd', function(e) {
     var marker = e.layer,
         feature = marker.feature;

     // Create custom popup content
     var popupContent =  '<a target="_blank" class="popup" href="' + feature.properties.url + '">' +
                             '<img src="' + feature.properties.image + '">' +
                         '   <h2>' + feature.properties.city + '</h2>' +
                         '</a>';

     // http://leafletjs.com/reference.html#popup
     marker.bindPopup(popupContent,{
         closeButton: false,
         minWidth: 320
     });
 });

 // Add features to the map
 map.markerLayer.setGeoJSON(geoJson);

 map.setView([0, 0], 2);
</script>
